<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.spring.hospital.dao.HospitalMapper">

	<sql id="selectOption">
		<where>
		<if test="keyfield != null">
			<if test="keyfield == '서울특별시'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '부산광역시'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '대구광역시'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '인천광역시'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '광주광역시'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '대전광역시'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '울산광역시'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '세종특별자치시'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '경기도'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '강원도'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '충청북도'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '충청남도'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '전라북도'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '전라남도'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '경상북도'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '경상남도'">
				hospital_region = #{keyfield}
			</if>
			<if test="keyfield == '제주특별자치도'">
				hospital_region = #{keyfield}
			</if>
		</if>
		</where>
	</sql>

	<select id="selectRegionListCount" parameterType="map" resultType="integer">
		SELECT
			COUNT(*)
		FROM hospital
		<include refid="selectOption"></include>
	</select>

	  	<select id="selectStoredHosList" parameterType="map" resultType="hospitalVO">
  		SELECT
  		   *
  		FROM (SELECT
  		        a.*,
  		        rownum rnum
  		      FROM (SELECT
  		              *
  		            FROM hospital h LEFT OUTER JOIN hospital_detail d 
  		            ON h.hospital_num = d.hospital_num
  		            <include refid="selectOption"></include>
  		            )a)                         
  		<![CDATA[
  		WHERE rnum >= #{start} AND rnum <= #{end}
  		]]>
  	</select>
</mapper>
















